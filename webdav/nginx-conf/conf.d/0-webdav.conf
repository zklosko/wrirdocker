# Boilerplate code from https://starbeamrainbowlabs.com/blog/article.php?article=posts%2F237-WebDav-Nginx-Setup.html

server {
    listen 443;
    listen [::]:443;

    server_name files.wrir.org;

    # Would need change to auth_digest unless SSL used
    auth_basic              wrir_webdav;
    auth_basic_user_file    /etc/nginx/passwd.dav;

    dav_methods     PUT DELETE MKCOL COPY MOVE;
    dav_ext_methods PROPFIND OPTIONS;
    # Removed all:r from string, requires user account for access
    dav_access      user:rw group:rw;

    # This fixes 403 forbidden errors - thanks zmej! Rref https://starbeamrainbowlabs.com/blog/article.php?article=posts%2F237-WebDav-Nginx-Setup.html#adykboslcbxwacvlbhe1b8zbb97m
    autoindex on;

    # Some systems require you to actually create this directory before starting nginx.
    # If this is the case on your system, you may need to move it outside `/tmp` and create the directory manually (not forgetting to give ownership
    # to www-data with chown).
    # Thanks to @joe for pointing this out in a comment!
    client_body_temp_path   /tmp/nginx/client-bodies;
    client_max_body_size    0;
    create_full_put_path    on;

    # I think this is where we'd mount our shared directories
    root /var/www;
}